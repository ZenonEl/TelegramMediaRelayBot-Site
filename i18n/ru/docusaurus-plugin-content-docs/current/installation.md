# üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

## üìã –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç       | –í–µ—Ä—Å–∏—è       | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                                  |
|-----------------|--------------|---------------------------------------------|
| .NET Runtime    | 8.0+         | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞                    |
| MySQL Server    | 8.0+         | –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö              |
| yt-dlp          | 2024.04.09+  | –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ PATH –∏–ª–∏ —Ä—è–¥–æ–º —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º —Ñ–∞–π–ª–æ–º |

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –û–°
- **Linux** (x64): –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Linux Mint. –ü–æ—ç—Ç–æ–º—É, –ø–æ—Ö–æ–∂–∏–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã –¥–æ–ª–∂–Ω—ã —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞—Ç—å, –≥–ª–∞–≤–Ω–æ–µ –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ
- **Windows** 10/11 (x64) - —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è —Å–±–æ—Ä–∫–∞, –∞ —Ç–∞–∫–∂–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- **macOS** (x64/ARM) - –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª–∞—Å—å

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è Linux

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
```bash
# –î–ª—è Ubuntu/Debian
sudo apt update && sudo apt install -y \
    git \
    mysql-server \
    libicu-dev

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ .NET 8
wget https://packages.microsoft.com/config/ubuntu/22.04/packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
sudo apt update && sudo apt install -y dotnet-sdk-8.0

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/ZenonEl/TelegramMediaRelayBot.git
cd TelegramMediaRelayBot

# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ yt-dlp –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O yt-dlp
chmod +x yt-dlp

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
# –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ —à–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
dotnet run --project TelegramMediaRelayBot.csproj
# –ò–ª–∏
dotnet restore
dotnet run
```
#### 1.1 –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª

1. –°–∫–∞—á–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π [—Ä–µ–ª–∏–∑](https://github.com/ZenonEl/TelegramMediaRelayBot/releases/latest)
2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤ –≤ —É–¥–æ–±–Ω–æ–µ –º–µ—Å—Ç–æ 
3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª appsettings.json:
    - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞ appsettings.json.example
4. –°–∫–∞—á–∞–π—Ç–µ yt-dlp:
    ```bash
    wget https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp -O yt-dlp
    chmod +x yt-dlp
    ```
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª:
    ```bash
    ./TelegramMediaRelayBot
    ```


---

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MySQL**

#### **2.1 –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤ MySQL –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
CREATE DATABASE TelegramMediaRelayBot;

-- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–æ–ª—è
CREATE USER 'media_bot'@'localhost' IDENTIFIED BY 'StrongPassword123!';

-- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
GRANT ALL PRIVILEGES ON TelegramMediaRelayBot.* TO 'media_bot'@'localhost';

-- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
FLUSH PRIVILEGES;
```

---

#### **2.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MySQL, –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª `appsettings.json`. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤–∞—à–µ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ MySQL:

```json
{
    "AppSettings": {
        "SqlConnectionString": "Server=localhost;Database=TelegramMediaRelayBot;User ID=media_bot;Password=StrongPassword123!;",
        "DatabaseName": "TelegramMediaRelayBot"
    }
}
```

- **Server**: –ê–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ MySQL (–æ–±—ã—á–Ω–æ `localhost`, –µ—Å–ª–∏ MySQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Ç–æ–º –∂–µ —Å–µ—Ä–≤–µ—Ä–µ –∏–ª–∏ –ü–ö).
- **Database**: –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `TelegramMediaRelayBot`).
- **User ID**: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `media_bot`).
- **Password**: –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `StrongPassword123!`).

---

#### **2.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MySQL –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.

---

### 3. –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
```bash
cp appsettings.json.example \
   appsettings.json

# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥
nano ./appsettings.json
```
–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
    - –ï—Å–ª–∏ –≤–∞–º –Ω–µ –Ω—É–∂–µ–Ω Tor —Ç–æ –æ—Å—Ç–∞–≤—å—Ç–µ "Proxy" –ø—É—Å—Ç—ã–º ("") –∏ –≤ Tor.Enabled –Ω–∞–ø–∏—à–∏—Ç–µ false
    - –í –æ—Å—Ç–∞–ª—å–Ω–æ–º –∂–µ, –∫—Ä–æ–º–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –±–ª–æ–∫–µ "AppSettings" –±–æ–ª—å—à–µ –º–æ–∂–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è—Ç—å.
    - –¢–æ–∫–µ–Ω –¥–ª—è "TelegramBotToken" –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º –±–æ—Ç–µ —Ç–µ–ª–µ–≥—Ä–∞–º [BotFather](https://t.me/BotFather)
    - –î–ª—è –±–ª–æ–∫–∞ "AccessPolicy" –∏–º–µ–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ.
```json
{
    "AppSettings": {
        "TelegramBotToken": "1234:abcd",
        "SqlConnectionString": "Server=localhost;Database=TelegramMediaRelayBot;User ID=media_bot;Password=StrongPassword123!;",
        "DatabaseName": "TelegramMediaRelayBot",
        "Language": "en-US",
        "Proxy": "socks5://127.0.0.1:9050",
        "UserUnMuteCheckInterval": 20
    },
    "Tor": {
        "Enabled": true,
        "TorControlPassword": "Password",
        "TorSocksHost": "127.0.0.1",
        "TorSocksPort": 9050,
        "TorControlPort": 9051,
        "TorChangingChainInterval": 5
    },
    "MessageDelaySettings": {
        "VideoGetDelay": 1000,
        "ContactSendDelay": 1000
    },
    "ConsoleOutputSettings": {
        "LogLevel": "Information",
        "ShowVideoDownloadProgress": false,
        "ShowVideoUploadProgress": false
    },
    "AccessPolicy": {
        "Enabled": true,

        "NewUsersPolicy": {
            "Enabled": true,

            "AllowNewUsers": true,
            "AllowRules": {
                "AllowAll": false,
                "WhitelistedReferrerIds": [],
                "BlacklistedReferrerIds": []
            }
        }
    }
}
```